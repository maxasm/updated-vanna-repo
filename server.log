2026-01-26 15:04:15,001 [VANNA API] INFO: Initialized Agent
2026-01-26 15:04:15,010 [VANNA API] INFO: Loaded conversation history from conversation_history.json
/home/m9x/SRC/vanna-ai-app/api.py:1008: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
2026-01-26 15:04:15,074 [VANNA API] DEBUG: Using selector: EpollSelector
2026-01-26 15:04:15,365 [VANNA API] DEBUG: Starting component System
2026-01-26 15:04:15,365 [VANNA API] DEBUG: Starting component Posthog
2026-01-26 15:04:15,448 [VANNA API] INFO: Loaded 2 query patterns and 18 tool patterns
2026-01-26 15:04:15,449 [VANNA API] INFO: Loaded 2 query patterns
INFO:     Started server process [50842]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
2026-01-26 15:04:25,980 [VANNA API] INFO: POST /api/v1/chat
2026-01-26 15:04:26,332 [VANNA API] DEBUG: Component type: UiComponent, attributes: ['construct', 'copy', 'dict', 'from_orm', 'json', 'model_computed_fields', 'model_config', 'model_construct', 'model_copy', 'model_dump', 'model_dump_json', 'model_extra', 'model_fields', 'model_fields_set', 'model_json_schema', 'model_parametrized_name', 'model_post_init', 'model_rebuild', 'model_validate', 'model_validate_json', 'model_validate_strings', 'parse_file', 'parse_obj', 'parse_raw', 'rich_component', 'schema', 'schema_json', 'simple_component', 'timestamp', 'update_forward_refs', 'validate', 'validate_components']
/home/m9x/SRC/vanna-ai-app/api.py:678: PydanticDeprecatedSince211: Accessing the 'model_computed_fields' attribute on the instance is deprecated. Instead, you should access this attribute from the model class. Deprecated in Pydantic V2.11 to be removed in V3.0.
  attr_value = getattr(component, attr_name)
/home/m9x/SRC/vanna-ai-app/api.py:678: PydanticDeprecatedSince211: Accessing the 'model_fields' attribute on the instance is deprecated. Instead, you should access this attribute from the model class. Deprecated in Pydantic V2.11 to be removed in V3.0.
  attr_value = getattr(component, attr_name)
2026-01-26 15:04:26,333 [VANNA API] DEBUG: Component type: UiComponent, attributes: ['construct', 'copy', 'dict', 'from_orm', 'json', 'model_computed_fields', 'model_config', 'model_construct', 'model_copy', 'model_dump', 'model_dump_json', 'model_extra', 'model_fields', 'model_fields_set', 'model_json_schema', 'model_parametrized_name', 'model_post_init', 'model_rebuild', 'model_validate', 'model_validate_json', 'model_validate_strings', 'parse_file', 'parse_obj', 'parse_raw', 'rich_component', 'schema', 'schema_json', 'simple_component', 'timestamp', 'update_forward_refs', 'validate', 'validate_components']
2026-01-26 15:04:26,335 [VANNA API] DEBUG: Component type: UiComponent, attributes: ['construct', 'copy', 'dict', 'from_orm', 'json', 'model_computed_fields', 'model_config', 'model_construct', 'model_copy', 'model_dump', 'model_dump_json', 'model_extra', 'model_fields', 'model_fields_set', 'model_json_schema', 'model_parametrized_name', 'model_post_init', 'model_rebuild', 'model_validate', 'model_validate_json', 'model_validate_strings', 'parse_file', 'parse_obj', 'parse_raw', 'rich_component', 'schema', 'schema_json', 'simple_component', 'timestamp', 'update_forward_refs', 'validate', 'validate_components']
2026-01-26 15:04:26,417 [VANNA API] DEBUG: WARNING: No ONNX providers provided, defaulting to available providers: ['AzureExecutionProvider', 'CPUExecutionProvider']
2026-01-26 15:04:27,007 [VANNA API] DEBUG: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-6ba20ce3-f1e7-4b6d-bc61-34bd865d9722', 'json_data': {'messages': [{'role': 'system', 'content': "You are Vanna, an AI data analyst assistant created to help users with data analysis tasks. Today's date is 2026-01-26.\n\nResponse Guidelines:\n- Any summary of what you did or observations should be the final step.\n- Use the available tools to help the user accomplish their goals.\n- When you execute a query, that raw result is shown to the user outside of your response so YOU DO NOT need to include it in your response. Focus on summarizing and interpreting the results.\n\nYou have access to the following tools: run_sql, visualize_data"}, {'role': 'user', 'content': 'Previous conversation context:\n1. Q: Show me a chart of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n2. Q: Show me the number of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n3. Q: Show me the number of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n\nRelevant previous conversations:\n1. Q: Show me a chart of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n2. Q: Show me the number of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n\nCurrent question: Show me a chart of tables per schema'}], 'model': 'gpt-5', 'stream': True, 'tool_choice': 'auto', 'tools': [{'type': 'function', 'function': {'name': 'run_sql', 'description': 'Execute SQL queries against the configured database', 'parameters': {'description': 'Arguments for run_sql tool.', 'properties': {'sql': {'description': 'SQL query to execute', 'title': 'Sql', 'type': 'string'}}, 'required': ['sql'], 'title': 'RunSqlToolArgs', 'type': 'object'}}}, {'type': 'function', 'function': {'name': 'visualize_data', 'description': 'Create a visualization from a CSV file. The tool automatically selects an appropriate chart type based on the data.', 'parameters': {'description': 'Arguments for visualize_data tool.', 'properties': {'filename': {'description': 'Name of the CSV file to visualize', 'title': 'Filename', 'type': 'string'}, 'title': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'Optional title for the chart', 'title': 'Title'}}, 'required': ['filename'], 'title': 'VisualizeDataArgs', 'type': 'object'}}}]}}
2026-01-26 15:04:27,010 [VANNA API] DEBUG: Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2026-01-26 15:04:27,010 [VANNA API] DEBUG: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2026-01-26 15:04:27,107 [VANNA API] DEBUG: connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f8ea5eea900>
2026-01-26 15:04:27,107 [VANNA API] DEBUG: start_tls.started ssl_context=<ssl.SSLContext object at 0x7f8eff246fd0> server_hostname='api.openai.com' timeout=5.0
2026-01-26 15:04:27,135 [VANNA API] DEBUG: start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f8ea5ef3890>
2026-01-26 15:04:27,135 [VANNA API] DEBUG: send_request_headers.started request=<Request [b'POST']>
2026-01-26 15:04:27,137 [VANNA API] DEBUG: send_request_headers.complete
2026-01-26 15:04:27,137 [VANNA API] DEBUG: send_request_body.started request=<Request [b'POST']>
2026-01-26 15:04:27,137 [VANNA API] DEBUG: send_request_body.complete
2026-01-26 15:04:27,138 [VANNA API] DEBUG: receive_response_headers.started request=<Request [b'POST']>
2026-01-26 15:05:11,214 [VANNA API] DEBUG: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 Jan 2026 12:05:11 GMT'), (b'Content-Type', b'text/event-stream; charset=utf-8'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-cufmhftvaehgcxfsdfciylmi'), (b'openai-processing-ms', b'43726'), (b'openai-project', b'proj_9jsDZuesR0EiSahl5ziUgOOZ'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'43750'), (b'x-ratelimit-limit-requests', b'500'), (b'x-ratelimit-limit-tokens', b'500000'), (b'x-ratelimit-remaining-requests', b'499'), (b'x-ratelimit-remaining-tokens', b'499639'), (b'x-ratelimit-reset-requests', b'120ms'), (b'x-ratelimit-reset-tokens', b'43ms'), (b'x-request-id', b'req_861780de752f41a998e4bb495629bfe5'), (b'x-openai-proxy-wasm', b'v0.1'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=QFzfd3.SI5uN3wSJO7eGTL9O.Zn70OrvR.l.UA6yhDU-1769429111-1.0.1.1-4rNqy_U8iHajg2.55zLqVZJMGLk.XGl_jDMD4UUuXPK_k9hYk6MuZ4ABmHN.r284pngDRsxpkYAX9.UWHdtQ5slUd9tMsUwYc12BCNJCA3s; path=/; expires=Mon, 26-Jan-26 12:35:11 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=U3NxIe51oSo8rZquSTVX9lnOYjkHpUmaXF6DxpDrMSY-1769429111165-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9c3fdf75ac6a8a61-MBA'), (b'alt-svc', b'h3=":443"; ma=86400')])
2026-01-26 15:05:11,217 [VANNA API] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-26 15:05:11,217 [VANNA API] DEBUG: HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 26 Jan 2026 12:05:11 GMT'), ('content-type', 'text/event-stream; charset=utf-8'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-cufmhftvaehgcxfsdfciylmi'), ('openai-processing-ms', '43726'), ('openai-project', 'proj_9jsDZuesR0EiSahl5ziUgOOZ'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '43750'), ('x-ratelimit-limit-requests', '500'), ('x-ratelimit-limit-tokens', '500000'), ('x-ratelimit-remaining-requests', '499'), ('x-ratelimit-remaining-tokens', '499639'), ('x-ratelimit-reset-requests', '120ms'), ('x-ratelimit-reset-tokens', '43ms'), ('x-request-id', 'req_861780de752f41a998e4bb495629bfe5'), ('x-openai-proxy-wasm', 'v0.1'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=QFzfd3.SI5uN3wSJO7eGTL9O.Zn70OrvR.l.UA6yhDU-1769429111-1.0.1.1-4rNqy_U8iHajg2.55zLqVZJMGLk.XGl_jDMD4UUuXPK_k9hYk6MuZ4ABmHN.r284pngDRsxpkYAX9.UWHdtQ5slUd9tMsUwYc12BCNJCA3s; path=/; expires=Mon, 26-Jan-26 12:35:11 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=U3NxIe51oSo8rZquSTVX9lnOYjkHpUmaXF6DxpDrMSY-1769429111165-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '9c3fdf75ac6a8a61-MBA'), ('alt-svc', 'h3=":443"; ma=86400')])
2026-01-26 15:05:11,217 [VANNA API] DEBUG: request_id: req_861780de752f41a998e4bb495629bfe5
2026-01-26 15:05:11,218 [VANNA API] DEBUG: receive_response_body.started request=<Request [b'POST']>
2026-01-26 15:05:11,858 [VANNA API] DEBUG: response_closed.started
2026-01-26 15:05:11,858 [VANNA API] DEBUG: response_closed.complete
2026-01-26 15:05:11,859 [VANNA API] DEBUG: receive_response_body.failed exception=GeneratorExit()
2026-01-26 15:05:11,874 [VANNA API] DEBUG: Component type: UiComponent, attributes: ['construct', 'copy', 'dict', 'from_orm', 'json', 'model_computed_fields', 'model_config', 'model_construct', 'model_copy', 'model_dump', 'model_dump_json', 'model_extra', 'model_fields', 'model_fields_set', 'model_json_schema', 'model_parametrized_name', 'model_post_init', 'model_rebuild', 'model_validate', 'model_validate_json', 'model_validate_strings', 'parse_file', 'parse_obj', 'parse_raw', 'rich_component', 'schema', 'schema_json', 'simple_component', 'timestamp', 'update_forward_refs', 'validate', 'validate_components']
/home/m9x/SRC/vanna-ai-app/api.py:678: PydanticDeprecatedSince211: Accessing the 'model_computed_fields' attribute on the instance is deprecated. Instead, you should access this attribute from the model class. Deprecated in Pydantic V2.11 to be removed in V3.0.
  attr_value = getattr(component, attr_name)
/home/m9x/SRC/vanna-ai-app/api.py:678: PydanticDeprecatedSince211: Accessing the 'model_fields' attribute on the instance is deprecated. Instead, you should access this attribute from the model class. Deprecated in Pydantic V2.11 to be removed in V3.0.
  attr_value = getattr(component, attr_name)
2026-01-26 15:05:11,876 [VANNA API] DEBUG: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-dd1e2af8-0141-45f1-b2f0-107b52ef2578', 'json_data': {'messages': [{'role': 'system', 'content': "You are Vanna, an AI data analyst assistant created to help users with data analysis tasks. Today's date is 2026-01-26.\n\nResponse Guidelines:\n- Any summary of what you did or observations should be the final step.\n- Use the available tools to help the user accomplish their goals.\n- When you execute a query, that raw result is shown to the user outside of your response so YOU DO NOT need to include it in your response. Focus on summarizing and interpreting the results.\n\nYou have access to the following tools: run_sql, visualize_data"}, {'role': 'user', 'content': 'Previous conversation context:\n1. Q: Show me a chart of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n2. Q: Show me the number of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n3. Q: Show me the number of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n\nRelevant previous conversations:\n1. Q: Show me a chart of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n2. Q: Show me the number of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n\nCurrent question: Show me a chart of tables per schema'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'call_uKl9j4bbYffA4EJtSZZhqRXt', 'type': 'function', 'function': {'name': 'run_sql', 'arguments': '{"sql": "SELECT\\n  table_schema AS schema_name,\\n  COUNT(*) AS table_count\\nFROM information_schema.tables\\nWHERE table_type = \'BASE TABLE\' AND table_schema NOT IN (\'information_schema\')\\nGROUP BY table_schema\\nORDER BY table_count DESC;"}'}}]}, {'role': 'tool', 'content': 'schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to file: query_results_387c5c52.csv\n\n**IMPORTANT: FOR VISUALIZE_DATA USE FILENAME: query_results_387c5c52.csv**', 'tool_call_id': 'call_uKl9j4bbYffA4EJtSZZhqRXt'}], 'model': 'gpt-5', 'stream': True, 'tool_choice': 'auto', 'tools': [{'type': 'function', 'function': {'name': 'run_sql', 'description': 'Execute SQL queries against the configured database', 'parameters': {'description': 'Arguments for run_sql tool.', 'properties': {'sql': {'description': 'SQL query to execute', 'title': 'Sql', 'type': 'string'}}, 'required': ['sql'], 'title': 'RunSqlToolArgs', 'type': 'object'}}}, {'type': 'function', 'function': {'name': 'visualize_data', 'description': 'Create a visualization from a CSV file. The tool automatically selects an appropriate chart type based on the data.', 'parameters': {'description': 'Arguments for visualize_data tool.', 'properties': {'filename': {'description': 'Name of the CSV file to visualize', 'title': 'Filename', 'type': 'string'}, 'title': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'Optional title for the chart', 'title': 'Title'}}, 'required': ['filename'], 'title': 'VisualizeDataArgs', 'type': 'object'}}}]}}
2026-01-26 15:05:11,877 [VANNA API] DEBUG: Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2026-01-26 15:05:11,878 [VANNA API] DEBUG: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2026-01-26 15:05:12,133 [VANNA API] DEBUG: connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f8ea46b4cd0>
2026-01-26 15:05:12,133 [VANNA API] DEBUG: start_tls.started ssl_context=<ssl.SSLContext object at 0x7f8eff246fd0> server_hostname='api.openai.com' timeout=5.0
2026-01-26 15:05:12,349 [VANNA API] DEBUG: start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f8ef42ffbb0>
2026-01-26 15:05:12,350 [VANNA API] DEBUG: send_request_headers.started request=<Request [b'POST']>
2026-01-26 15:05:12,351 [VANNA API] DEBUG: send_request_headers.complete
2026-01-26 15:05:12,352 [VANNA API] DEBUG: send_request_body.started request=<Request [b'POST']>
2026-01-26 15:05:12,352 [VANNA API] DEBUG: send_request_body.complete
2026-01-26 15:05:12,352 [VANNA API] DEBUG: receive_response_headers.started request=<Request [b'POST']>
2026-01-26 15:05:13,235 [VANNA API] DEBUG: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 Jan 2026 12:05:13 GMT'), (b'Content-Type', b'text/event-stream; charset=utf-8'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-cufmhftvaehgcxfsdfciylmi'), (b'openai-processing-ms', b'309'), (b'openai-project', b'proj_9jsDZuesR0EiSahl5ziUgOOZ'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'553'), (b'x-ratelimit-limit-requests', b'500'), (b'x-ratelimit-limit-tokens', b'500000'), (b'x-ratelimit-remaining-requests', b'499'), (b'x-ratelimit-remaining-tokens', b'499586'), (b'x-ratelimit-reset-requests', b'120ms'), (b'x-ratelimit-reset-tokens', b'49ms'), (b'x-request-id', b'req_9dc157822bb944cf95d6a211b43c2a95'), (b'x-openai-proxy-wasm', b'v0.1'), (b'cf-cache-status', b'DYNAMIC'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9c3fe0909d09ea38-FCO'), (b'alt-svc', b'h3=":443"; ma=86400')])
2026-01-26 15:05:13,236 [VANNA API] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-26 15:05:13,236 [VANNA API] DEBUG: HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 26 Jan 2026 12:05:13 GMT', 'content-type': 'text/event-stream; charset=utf-8', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-cufmhftvaehgcxfsdfciylmi', 'openai-processing-ms': '309', 'openai-project': 'proj_9jsDZuesR0EiSahl5ziUgOOZ', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '553', 'x-ratelimit-limit-requests': '500', 'x-ratelimit-limit-tokens': '500000', 'x-ratelimit-remaining-requests': '499', 'x-ratelimit-remaining-tokens': '499586', 'x-ratelimit-reset-requests': '120ms', 'x-ratelimit-reset-tokens': '49ms', 'x-request-id': 'req_9dc157822bb944cf95d6a211b43c2a95', 'x-openai-proxy-wasm': 'v0.1', 'cf-cache-status': 'DYNAMIC', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '9c3fe0909d09ea38-FCO', 'alt-svc': 'h3=":443"; ma=86400'})
2026-01-26 15:05:13,236 [VANNA API] DEBUG: request_id: req_9dc157822bb944cf95d6a211b43c2a95
2026-01-26 15:05:13,237 [VANNA API] DEBUG: receive_response_body.started request=<Request [b'POST']>
2026-01-26 15:05:13,334 [VANNA API] DEBUG: response_closed.started
2026-01-26 15:05:13,335 [VANNA API] DEBUG: response_closed.complete
2026-01-26 15:05:13,335 [VANNA API] DEBUG: receive_response_body.failed exception=GeneratorExit()
2026-01-26 15:05:13,336 [VANNA API] INFO: Starting visualization for file: query_results_387c5c52.csv
2026-01-26 15:05:13,337 [VANNA API] INFO: Read 78 bytes from CSV file
2026-01-26 15:05:13,340 [VANNA API] INFO: Parsed DataFrame with shape (4, 2), columns: ['schema_name', 'table_count'], dtypes: {'schema_name': <StringDtype(storage='python', na_value=nan)>, 'table_count': dtype('int64')}
2026-01-26 15:05:13,341 [VANNA API] INFO: Generating chart...
2026-01-26 15:05:13,591 [VANNA API] INFO: Chart generated, type: <class 'dict'>, keys: ['data', 'layout']
2026-01-26 15:05:13,592 [VANNA API] INFO: Creating ChartComponent...
2026-01-26 15:05:13,592 [VANNA API] INFO: ChartComponent created successfully
2026-01-26 15:05:13,592 [VANNA API] INFO: Creating ToolResult...
2026-01-26 15:05:13,592 [VANNA API] INFO: ToolResult created successfully
2026-01-26 15:05:13,592 [VANNA API] DEBUG: Component type: UiComponent, attributes: ['construct', 'copy', 'dict', 'from_orm', 'json', 'model_computed_fields', 'model_config', 'model_construct', 'model_copy', 'model_dump', 'model_dump_json', 'model_extra', 'model_fields', 'model_fields_set', 'model_json_schema', 'model_parametrized_name', 'model_post_init', 'model_rebuild', 'model_validate', 'model_validate_json', 'model_validate_strings', 'parse_file', 'parse_obj', 'parse_raw', 'rich_component', 'schema', 'schema_json', 'simple_component', 'timestamp', 'update_forward_refs', 'validate', 'validate_components']
/home/m9x/SRC/vanna-ai-app/api.py:678: PydanticDeprecatedSince211:

Accessing the 'model_computed_fields' attribute on the instance is deprecated. Instead, you should access this attribute from the model class. Deprecated in Pydantic V2.11 to be removed in V3.0.

/home/m9x/SRC/vanna-ai-app/api.py:678: PydanticDeprecatedSince211:

Accessing the 'model_fields' attribute on the instance is deprecated. Instead, you should access this attribute from the model class. Deprecated in Pydantic V2.11 to be removed in V3.0.

2026-01-26 15:05:13,595 [VANNA API] DEBUG: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-21036c97-80df-499c-94ec-08b5bc854bd8', 'json_data': {'messages': [{'role': 'system', 'content': "You are Vanna, an AI data analyst assistant created to help users with data analysis tasks. Today's date is 2026-01-26.\n\nResponse Guidelines:\n- Any summary of what you did or observations should be the final step.\n- Use the available tools to help the user accomplish their goals.\n- When you execute a query, that raw result is shown to the user outside of your response so YOU DO NOT need to include it in your response. Focus on summarizing and interpreting the results.\n\nYou have access to the following tools: run_sql, visualize_data"}, {'role': 'user', 'content': 'Previous conversation context:\n1. Q: Show me a chart of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n2. Q: Show me the number of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n3. Q: Show me the number of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n\nRelevant previous conversations:\n1. Q: Show me a chart of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n2. Q: Show me the number of tables per schema\n   A: schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to fil...\n\nCurrent question: Show me a chart of tables per schema'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'call_uKl9j4bbYffA4EJtSZZhqRXt', 'type': 'function', 'function': {'name': 'run_sql', 'arguments': '{"sql": "SELECT\\n  table_schema AS schema_name,\\n  COUNT(*) AS table_count\\nFROM information_schema.tables\\nWHERE table_type = \'BASE TABLE\' AND table_schema NOT IN (\'information_schema\')\\nGROUP BY table_schema\\nORDER BY table_count DESC;"}'}}]}, {'role': 'tool', 'content': 'schema_name,table_count\nperformance_schema,111\nmysql,38\nclassicmodels,8\nsys,1\n\n\nResults saved to file: query_results_387c5c52.csv\n\n**IMPORTANT: FOR VISUALIZE_DATA USE FILENAME: query_results_387c5c52.csv**', 'tool_call_id': 'call_uKl9j4bbYffA4EJtSZZhqRXt'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'call_3rKKiByqqnby63riUfoeG20N', 'type': 'function', 'function': {'name': 'visualize_data', 'arguments': '{"filename": "query_results_387c5c52.csv", "title": "Tables per schema"}'}}]}, {'role': 'tool', 'content': "Created visualization from 'query_results_387c5c52.csv' (4 rows, 2 columns).", 'tool_call_id': 'call_3rKKiByqqnby63riUfoeG20N'}], 'model': 'gpt-5', 'stream': True, 'tool_choice': 'auto', 'tools': [{'type': 'function', 'function': {'name': 'run_sql', 'description': 'Execute SQL queries against the configured database', 'parameters': {'description': 'Arguments for run_sql tool.', 'properties': {'sql': {'description': 'SQL query to execute', 'title': 'Sql', 'type': 'string'}}, 'required': ['sql'], 'title': 'RunSqlToolArgs', 'type': 'object'}}}, {'type': 'function', 'function': {'name': 'visualize_data', 'description': 'Create a visualization from a CSV file. The tool automatically selects an appropriate chart type based on the data.', 'parameters': {'description': 'Arguments for visualize_data tool.', 'properties': {'filename': {'description': 'Name of the CSV file to visualize', 'title': 'Filename', 'type': 'string'}, 'title': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'Optional title for the chart', 'title': 'Title'}}, 'required': ['filename'], 'title': 'VisualizeDataArgs', 'type': 'object'}}}]}}
2026-01-26 15:05:13,596 [VANNA API] DEBUG: Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2026-01-26 15:05:13,597 [VANNA API] DEBUG: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2026-01-26 15:05:13,631 [VANNA API] DEBUG: connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f8ea46d8180>
2026-01-26 15:05:13,632 [VANNA API] DEBUG: start_tls.started ssl_context=<ssl.SSLContext object at 0x7f8eff246fd0> server_hostname='api.openai.com' timeout=5.0
2026-01-26 15:05:13,651 [VANNA API] DEBUG: start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f8ea465cdd0>
2026-01-26 15:05:13,652 [VANNA API] DEBUG: send_request_headers.started request=<Request [b'POST']>
2026-01-26 15:05:13,652 [VANNA API] DEBUG: send_request_headers.complete
2026-01-26 15:05:13,652 [VANNA API] DEBUG: send_request_body.started request=<Request [b'POST']>
2026-01-26 15:05:13,652 [VANNA API] DEBUG: send_request_body.complete
2026-01-26 15:05:13,652 [VANNA API] DEBUG: receive_response_headers.started request=<Request [b'POST']>
2026-01-26 15:05:16,026 [VANNA API] DEBUG: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 Jan 2026 12:05:16 GMT'), (b'Content-Type', b'text/event-stream; charset=utf-8'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-cufmhftvaehgcxfsdfciylmi'), (b'openai-processing-ms', b'282'), (b'openai-project', b'proj_9jsDZuesR0EiSahl5ziUgOOZ'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'297'), (b'x-ratelimit-limit-requests', b'500'), (b'x-ratelimit-limit-tokens', b'500000'), (b'x-ratelimit-remaining-requests', b'499'), (b'x-ratelimit-remaining-tokens', b'499565'), (b'x-ratelimit-reset-requests', b'120ms'), (b'x-ratelimit-reset-tokens', b'52ms'), (b'x-request-id', b'req_5a153530c7bd4084beff0af37de6d0b6'), (b'x-openai-proxy-wasm', b'v0.1'), (b'cf-cache-status', b'DYNAMIC'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9c3fe0985b841b5a-NBO'), (b'alt-svc', b'h3=":443"; ma=86400')])
2026-01-26 15:05:16,026 [VANNA API] INFO: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-26 15:05:16,026 [VANNA API] DEBUG: HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 26 Jan 2026 12:05:16 GMT', 'content-type': 'text/event-stream; charset=utf-8', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-cufmhftvaehgcxfsdfciylmi', 'openai-processing-ms': '282', 'openai-project': 'proj_9jsDZuesR0EiSahl5ziUgOOZ', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '297', 'x-ratelimit-limit-requests': '500', 'x-ratelimit-limit-tokens': '500000', 'x-ratelimit-remaining-requests': '499', 'x-ratelimit-remaining-tokens': '499565', 'x-ratelimit-reset-requests': '120ms', 'x-ratelimit-reset-tokens': '52ms', 'x-request-id': 'req_5a153530c7bd4084beff0af37de6d0b6', 'x-openai-proxy-wasm': 'v0.1', 'cf-cache-status': 'DYNAMIC', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '9c3fe0985b841b5a-NBO', 'alt-svc': 'h3=":443"; ma=86400'})
2026-01-26 15:05:16,027 [VANNA API] DEBUG: request_id: req_5a153530c7bd4084beff0af37de6d0b6
2026-01-26 15:05:16,027 [VANNA API] DEBUG: receive_response_body.started request=<Request [b'POST']>
2026-01-26 15:05:16,931 [VANNA API] DEBUG: response_closed.started
2026-01-26 15:05:16,932 [VANNA API] DEBUG: response_closed.complete
2026-01-26 15:05:16,932 [VANNA API] DEBUG: receive_response_body.failed exception=GeneratorExit()
2026-01-26 15:05:16,933 [VANNA API] DEBUG: Component type: UiComponent, attributes: ['construct', 'copy', 'dict', 'from_orm', 'json', 'model_computed_fields', 'model_config', 'model_construct', 'model_copy', 'model_dump', 'model_dump_json', 'model_extra', 'model_fields', 'model_fields_set', 'model_json_schema', 'model_parametrized_name', 'model_post_init', 'model_rebuild', 'model_validate', 'model_validate_json', 'model_validate_strings', 'parse_file', 'parse_obj', 'parse_raw', 'rich_component', 'schema', 'schema_json', 'simple_component', 'timestamp', 'update_forward_refs', 'validate', 'validate_components']
2026-01-26 15:05:16,934 [VANNA API] DEBUG: Component type: UiComponent, attributes: ['construct', 'copy', 'dict', 'from_orm', 'json', 'model_computed_fields', 'model_config', 'model_construct', 'model_copy', 'model_dump', 'model_dump_json', 'model_extra', 'model_fields', 'model_fields_set', 'model_json_schema', 'model_parametrized_name', 'model_post_init', 'model_rebuild', 'model_validate', 'model_validate_json', 'model_validate_strings', 'parse_file', 'parse_obj', 'parse_raw', 'rich_component', 'schema', 'schema_json', 'simple_component', 'timestamp', 'update_forward_refs', 'validate', 'validate_components']
2026-01-26 15:05:16,936 [VANNA API] DEBUG: Component type: UiComponent, attributes: ['construct', 'copy', 'dict', 'from_orm', 'json', 'model_computed_fields', 'model_config', 'model_construct', 'model_copy', 'model_dump', 'model_dump_json', 'model_extra', 'model_fields', 'model_fields_set', 'model_json_schema', 'model_parametrized_name', 'model_post_init', 'model_rebuild', 'model_validate', 'model_validate_json', 'model_validate_strings', 'parse_file', 'parse_obj', 'parse_raw', 'rich_component', 'schema', 'schema_json', 'simple_component', 'timestamp', 'update_forward_refs', 'validate', 'validate_components']
2026-01-26 15:05:17,257 [VANNA API] INFO: New CSV generated: /home/m9x/SRC/vanna-ai-app/c81e61d825b2d9b7/query_results_387c5c52.csv
2026-01-26 15:05:17,291 [VANNA API] DEBUG: WARNING: No ONNX providers provided, defaulting to available providers: ['AzureExecutionProvider', 'CPUExecutionProvider']
2026-01-26 15:05:17,654 [VANNA API] DEBUG: WARNING: No ONNX providers provided, defaulting to available providers: ['AzureExecutionProvider', 'CPUExecutionProvider']
2026-01-26 15:05:17,939 [VANNA API] INFO: Recorded successful tool usage: agent_execution
2026-01-26 15:05:17,943 [VANNA API] INFO: POST /api/v1/chat -> 200
INFO:     127.0.0.1:36938 - "POST /api/v1/chat HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [50842]
